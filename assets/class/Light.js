var Light = Class.extend({	init: function(paramsJSON){		this.canvas = document.getElementById(paramsJSON.canvasId);		this.context = this.canvas.getContext('2d');		this.canvas.width = window.innerWidth;		this.canvas.height = window.innerHeight;		this.globalCompositeOperation = 'lighter';		this.count = 0;		this.particles = [];		this.clear();		//this.open();		this.midfield();		this.render();	},	open: function(){		for (var i = 0; i < 260; i++) {			this.drawParticle('open',i);		}	},	midfield: function(){		for (var i = 0; i < 260; i++) {			this.drawParticle('midfield',i);		}	},	clear: function(){		this.context.clearRect(0, 0, this.canvas.width, this.canvas.height);	},	drawParticle: function(state,index){		var colors = [			'rgba(153, 255, 255, 0.35)',			'rgba(142, 68, 173, 0.35)',			'rgba(41, 178, 246, 0.35)'		];		var color = Math.floor(Math.random() * colors.length);		var particle = state == 'open'?{			x: window.innerWidth/2,			y: window.innerHeight-90,			size: 15,			color: colors[color],			Xvelocity: 0,			Yvelocity: Math.random()*20-20,			Rvelocity: -0.5,			opacity: 1,			dead: false		}:{			x: window.innerWidth/2,			y: window.innerHeight/2,			size: 35,			color: colors[color],			Xvelocity: 4*Math.random()*Math.sin(index),			Yvelocity: 3*Math.random()*Math.cos(index),			Rvelocity: 0.2*Math.random()-0.1,			opacity: 1,			dead: false		};		this.particles.push(particle);	},	render: function(){		this.count += 1;		this.clear();		for(var i = 0,len = this.particles.length; i < len; i++){			if(this.particles[i]){				if(this.particles[i].dead){					this.particles.splice(i, 1);				}else{					this.context.globalCompositeOperation = "lighter";					this.context.beginPath();					var gradient = this.context.createRadialGradient(this.particles[i].x, this.particles[i].y, 0, this.particles[i].x, this.particles[i].y, this.particles[i].size);					gradient.addColorStop(1, 'rgba(41, 178, 246, 0)');					gradient.addColorStop(0, this.particles[i].color);					this.context.fillStyle = gradient;					//if(this.particles[i].opacity>0.01){					//	this.particles[i].opacity -= 0.01;					//}else{					//	this.particles[i].opacity = 0;					//}					this.context.globalAlpha = this.particles[i].opacity;					this.context.arc(this.particles[i].x, this.particles[i].y, this.particles[i].size, 0, Math.PI * 2, true);					this.context.closePath();					this.context.fill();					this.particles[i].x += this.particles[i].Xvelocity;					this.particles[i].y += this.particles[i].Yvelocity;					this.particles[i].size += this.particles[i].Rvelocity;					if(this.particles[i].opacity<=0 || this.particles[i].size<0 || this.particles[i].x - this.particles[i].size > this.canvas.width || this.particles[i].x + this.particles[i].size < 0 || this.particles[i].y - this.particles[i].size > this.canvas.height || this.particles[i].y - this.particles[i].size < 0){						this.particles[i].dead = true;					}				}			}		}		if(this.count%200 == 0){			this.midfield();		}		requestAnimationFrame(this.render.bind(this));	}});